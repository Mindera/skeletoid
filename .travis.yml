language: android
dist: trusty


before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
    - $HOME/.android/build-cache

android:
  components:
    # The BuildTools version used by your project
    - tools
    - build-tools-29.0.2

    # The SDK version used to compile your project
    - android-29

    # Repos needed
    - extra-android-m2repository
    - extra-google-m2repository
    - extra-android-support
    - extra-google-google_play_services

  licenses:
      - 'android-sdk-preview-license-.+'
      - 'android-sdk-license-.+'
      - 'google-gdk-license-.+'
      - 'intel-android-extra-license.+'
      - '.+'

# https://sonarcloud.io/project/configuration?analysisMode=GitHubTravis&id=mydroidisbetterthanyours
addons:
  sonarcloud:
    organization: "mindera"
    token:
      secure: "UOlRCMFq19x4n8aBSjv/F+Vr1alt02QWqwFRXXqgZJ0kxyeUL10emoabUCTAKfUC57csi27Oh3AoswSm9hMcJ4vKuqZNiEC2jP4lOJAq0M69SbXpeAlRbnXTYUF7kEMki5m5KVXN0Fiw4WHjJLF3DuQbJwzIFlOZL8s159rYStQdFoeXA7Fdz5bc03144Ql3NNS4S1oivZRpCVBfgpR7shoZGt24yk67dpPRIZ8a0bIpKWcRvq0ork1eH0DJePJnJTjM1ZBpvGgQoyJtYAD8/YPqtXyvzz+6AXwY/4Szkt/eA2V9dFr9l+jZaKJRlr+Y1UjYAMRxML1VIbzFXR8U15ucnKh3SHcz7Xo8F9lHKG3Hui57+dvMfNrpx+wU3BiZzG3/OKqpBXMHhtVKFvlOdOV7dkIK3G6Fv4WXhMuaDtYWqqg4K/wOhDGvNFiXkGkoCeEzzDMaFJWMgJUmQb9oSAP51FjCSktKBsEnXhsC9zj2AwPRH9PU8WqjQuLsa7EWqef6DpkGQvIWJsygPqcPu81EdXYp6y2GxrV/g45LaFSq7ReJAZze3URGOdlDR7Rd+QLspeyDu2Zg6CdkxH3evFqwhZ079tDpt2UGeJoBNfIrr74HwpNq37/Hb/38dVkqw2yKA03ws5FvtSHzrfa2WXtcrRvOST9HAgAFD0elJYw="


script:
  # Compile the SDK
  - ./gradlew assemble

  # Run initTests
  - ./gradlew createGlobalSkeletoidUnitTestReport

  - ./gradlew sonarqube


  # Send coverage report to Sonarcloud:
  # Read more: https://github.com/arturdm/jacoco-android-gradle-plugin
  #- ./gradlew sonarqube -Dsonar.projectKey=$SONARCLOUD_PROJECT_KEY -Dsonar.organization=mindera -Dsonar.host.url=https://sonarcloud.io -Dsonar.login=$SONARCLOUD_PROJECT_LOGIN


